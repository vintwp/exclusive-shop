generator client {
  provider = "prisma-client-js"
  previewFeatures = ["prismaSchemaFolder"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

enum ItemOptionParameter {
  COLOR
  STORAGE
  VOLUME
  WHEEL_DIAMETER
  TYPE
  SIZE
}


// default image - no-image.webp


// #region item

model Item {
  id                Int @id @default(autoincrement()) 
  name              String
  url               String
  price             Int
  priceDiscount     Int
  ourItem           Boolean @default(false) @map("our_item")
  category          Category @relation(fields: [categoryName], references: [name]) 
  categoryName      String @map("category_name")
  brand             Brand @relation(fields: [brandName], references: [name]) 
  brandName         String @map("brand_name")
  groupOptions      GroupOptions[]
  groupKey          String
  itemStock         ItemStock?
  itemImage         ItemImage? @relation(fields: [itemImageId], references: [id])
  itemImageId       Int? @map("item_image_url")
  forSale           ItemForSales?
  bestSeller        ItemsBestSellers?
  itemSpecification ItemSpec?
  itemText          ItemText?

  createdAt     DateTime   @default(now()) @map("created_at")
  updatedAt     DateTime   @updatedAt @map("updated_at")
  
  @@map("item")
  @@unique([id, groupKey])
}

model ItemStock {
  id        Int   @id @default(autoincrement())
  stockQty  Int   @default(0)
  item      Item  @relation(fields: [itemId], references: [id])
  itemId    Int   @unique

  @@map("item_stock")
}

model GroupOptions {
  id                    Int @id @default(autoincrement())
  groupOption           ItemOptionParameter? @map("group_option")
  groupOptionValue      String? @map("group_option_value")
  groupOptionValueAdd   String? @default("") @map("group_option_value_additional")
  item                  Item @relation(fields: [itemId, itemGroupKey], references: [id, groupKey])
  itemId                Int
  itemGroupKey          String @map("group_key")
  createdAt             DateTime   @default(now()) @map("created_at")
  updatedAt             DateTime   @updatedAt @map("updated_at")
	
  @@map("item_group")

  @@unique([itemId, groupOption])
}

model ItemImage {
  id          Int @id @default(autoincrement())
  images      String[] @map("image_url")
  item        Item[]
  createdAt   DateTime   @default(now()) @map("created_at")
  updatedAt   DateTime   @updatedAt @map("updated_at")
	@@map("item_image")
}

model ItemSpec {
  id              Int @id @default(autoincrement())
  specification   Json @map("item_specs")
  item            Item  @relation(fields: [itemId], references: [id])
  itemId          Int   @unique
  @@map("item_specification")
}

model ItemText {
  id      Int @id @default(autoincrement())
  text    Json
  item    Item  @relation(fields: [itemId], references: [id])
  itemId  Int   @unique

  @@map("item_text")
}

model ItemForSales {
  id      Int   @id @default(autoincrement())
  item    Item  @relation(fields: [itemId], references: [id])
  itemId  Int   @unique 

  @@map("items_for_sales")
}

model ItemsBestSellers {
  id      Int   @id @default(autoincrement())
  item    Item  @relation(fields: [itemId], references: [id])
  itemId  Int   @unique

  @@map("items_best_sellers")
}

// #endregion




